data("longley")
g <- lm(Unemployed ~ GNP + Population, data=longley)
summary(g, cor=T)
length(g$res)
cor(g$res[-1],g$res[-16])
Sigma <- diag(16)
Sigma <- 0.31041ˆabs(row(Sigma)-col(Sigma)); Sigma
Sigma <- 0.31041^abs(row(Sigma)-col(Sigma)); Sigma
Sigma <- diag(16)
Sigma <- 0.31041^abs(row(Sigma)-col(Sigma))
sm <- chol(Sigma)
summary(g, cor=T)
colnames(longley)
x <- model.matrix(g)
sm <- chol(Sigma)
smi <- solve(t(sm))
sx <- smi %*% x
sy <- smi %*% longley$Unemployed
lm(sy  ̃ sx-1)$coef
lm(sy ~ sx-1)$coef
g <- gls(Unemployed~ GNP + Population,
correlation=corAR1(form ~ year), data=longley)
library(nlme)
g <- gls(Unemployed~ GNP + Population,
correlation=corAR1(form ~ year), data=longley)
g <- gls(Unemployed ~ GNP + Population,
correlation=corAR1(form ~ Year), data=longley)
g <- gls(Unemployed ~ GNP + Population,
correlation=corAR1(form = ~ Year), data=longley)
intervals(g)
